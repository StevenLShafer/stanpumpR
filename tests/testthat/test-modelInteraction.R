context("modelInteraction")

test_that("it returns the correct values", {
  propofol <- c(0.00000000, 0.59173000, 0.79861721, 0.81922345, 0.75772238, 0.66173265, 0.56145644, 0.46957346, 0.39175785,
    0.32183082, 0.27009590, 0.22238628, 0.19023883, 0.15809139, 0.13784150, 0.12023101, 0.10262052, 0.09313125,
    0.08450942, 0.07588758, 0.06886151, 0.06487912, 0.06089673, 0.05691434, 0.05293195, 0.05096499, 0.04900356,
    0.04704213, 0.04508069, 0.04311926, 0.04170764, 0.04054378, 0.03937991, 0.03821605, 0.03705219, 0.03588833,
    0.03479851, 0.03399117, 0.03318384, 0.03237651, 0.03156918, 0.03076185, 0.02995451, 0.02914718, 0.02840629,
    0.02782601, 0.02724573, 0.02666545, 0.02608517, 0.02550488, 0.02492460, 0.02434432, 0.02376404, 0.02318376,
    0.02271646, 0.02231628, 0.02191611, 0.02151594, 0.02111577, 0.02071559, 0.02031542, 0.01991525, 0.01951507,
    0.01911490, 0.01871473, 0.01831456, 0.01803276, 0.01777614, 0.01751952, 0.01726291, 0.01700629, 0.01674967,
    0.01649305, 0.01623643, 0.01597982, 0.01572320, 0.01546658, 0.01520996, 0.01495335, 0.01469673, 0.01448372,
    0.01433298, 0.01418224, 0.01403150, 0.01388076, 0.01373002, 0.01357928, 0.01342855, 0.01327781, 0.01312707,
    0.01297633, 0.01282559, 0.01267485, 0.01252411, 0.01237337, 0.01222263, 0.01207189, 0.01192115, 0.01179619,
    0.01167719)

  opioid <- c(
    0.00000, 42.59601, 76.30303, 95.38374, 106.55996, 112.46759, 114.22273, 113.15487, 110.42381, 106.84360,
    102.51707, 97.90997, 93.16543, 88.56293, 84.04808, 79.63727, 75.78233, 71.92740, 68.24935, 65.24554,
    62.24173, 59.23792, 56.79659, 54.63013, 52.46367, 50.29721, 48.43044, 46.95632, 45.48220, 44.00808,
    42.53396, 41.23550, 40.26108, 39.28665, 38.31223, 37.33780, 36.36338, 35.47333, 34.82300, 34.17268,
    33.52236, 32.87204, 32.22172, 31.57140, 30.92108, 30.45996, 30.00704, 29.55411, 29.10119, 28.64826,
    28.19534, 27.74241, 27.28949, 26.86160, 26.53049, 26.19938, 25.86826, 25.53715, 25.20604, 24.87493,
    24.54381, 24.21270, 23.88159, 23.55048, 23.27861, 23.03060, 22.78259, 22.53458, 22.28657, 22.03856,
    21.79054, 21.54253, 21.29452, 21.04651, 20.79850, 20.55049, 20.31112, 20.12709, 19.94307, 19.75904,
    19.57502, 19.39100, 19.20697, 19.02295, 18.83892, 18.65490, 18.47087, 18.28685, 18.10283, 17.91880,
    17.73478, 17.55288, 17.40599, 17.25911, 17.11222, 16.96534, 16.81845, 16.67156, 16.52468, 16.37779)

  actual <- modelInteraction(propofol, opioid)

  expected <- list(
    pNR = c(1.000000e+00, 1.128880e-02, 9.102897e-05, 2.618129e-05, 2.631216e-05, 5.164464e-05, 1.489189e-04, 5.345650e-04,
      2.096310e-03, 9.472356e-03, 3.763547e-02, 1.572293e-01, 4.102864e-01, 7.609350e-01, 9.132997e-01, 9.722406e-01,
      9.925067e-01, 9.969971e-01, 9.988020e-01, 9.995395e-01, 9.998117e-01, 9.999013e-01, 9.999478e-01, 9.999728e-01,
      9.999864e-01, 9.999914e-01, 9.999945e-01, 9.999964e-01, 9.999977e-01, 9.999986e-01, 9.999990e-01, 9.999993e-01,
      9.999995e-01, 9.999996e-01, 9.999997e-01, 9.999998e-01, 9.999999e-01, 9.999999e-01, 9.999999e-01, 9.999999e-01,
      1.000000e+00, 1.000000e+00, 1.000000e+00, 1.000000e+00, 1.000000e+00, 1.000000e+00, 1.000000e+00, 1.000000e+00,
      1.000000e+00, 1.000000e+00, 1.000000e+00, 1.000000e+00, 1.000000e+00, 1.000000e+00, 1.000000e+00, 1.000000e+00,
      1.000000e+00, 1.000000e+00, 1.000000e+00, 1.000000e+00, 1.000000e+00, 1.000000e+00, 1.000000e+00, 1.000000e+00,
      1.000000e+00, 1.000000e+00, 1.000000e+00, 1.000000e+00, 1.000000e+00, 1.000000e+00, 1.000000e+00, 1.000000e+00,
      1.000000e+00, 1.000000e+00, 1.000000e+00, 1.000000e+00, 1.000000e+00, 1.000000e+00, 1.000000e+00, 1.000000e+00,
      1.000000e+00, 1.000000e+00, 1.000000e+00, 1.000000e+00, 1.000000e+00, 1.000000e+00, 1.000000e+00, 1.000000e+00,
      1.000000e+00, 1.000000e+00, 1.000000e+00, 1.000000e+00, 1.000000e+00, 1.000000e+00, 1.000000e+00, 1.000000e+00,
      1.000000e+00, 1.000000e+00, 1.000000e+00, 1.000000e+00),
    pNRpropofol = c(1.0000000, 0.9999998, 0.9999984, 0.9999981, 0.9999989, 0.9999996, 0.9999999, 1.0000000, 1.0000000, 1.0000000,
      1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000,
      1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000,
      1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000,
      1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000,
      1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000,
      1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000,
      1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000,
      1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000,
      1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000, 1.0000000),
    pNRopioid = 1
  )

  expect_equal(expected, actual)
})
